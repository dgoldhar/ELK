<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Asciidoctor 1.5.4">
  <meta name="author" content="empow">
  <title>empowclassifier filter plugin</title>
  <link rel="stylesheet" href="https://asciidoclive.com/assets/asciidoctor.js/css/asciidoctor.css">
</head>

<body class="article">
  <div id="header">
    <h1>empowclassifier filter plugin</h1>
    <div class="details">
      <span id="author" class="author">empow</span><br>
      <span id="revnumber">version 0.1 January 2019</span>
    </div>
  </div>
  <div id="content">
    <div id="preamble">
      <div class="sectionbody">
        <div class="ulist">
          <ul>
            <li>
              <p>Plugin version:</p>
            </li>
            <li>
              <p>Released on:</p>
            </li>
            <li>
              <p>Changelog</p>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="sect1">
      <h2 id="_getting_help">Getting Help</h2>
      <div class="sectionbody">
        <div class="paragraph">
          <p>For questions about the plugin, open a topic in the <a href="http://discuss.elastic.co/">Discuss</a>            forums. For bugs or feature requests, open an issue in <a href="https://github.com/logstash-plugins/logstash-filter-fingerprint">Github</a>.
            For the list of Elastic supported plugins, please consult the <a href="https://www.elastic.co/support/matrix#matrix_logstash_plugins">Elastic Support Matrix</a>.</p>
        </div>
      </div>
    </div>
    <div class="sect1">
      <h2 id="_description">Description</h2>
      <div class="sectionbody">
        <div class="paragraph">
          <p>Returns classification information for attacks from the empow classification
            center, based on information in log strings.</p>
        </div>
      </div>
    </div>
    <div class="sect1">
      <h2 id="_configuration_options">Configuration Options</h2>
      <div class="sectionbody">
        <div class="paragraph">
          <p>Include the plugin in the filter section of your logstash config file like
            this:</p>
        </div>
        <div class="listingblock">
          <div class="content">
            <pre>filter {
    empowclassifier {
        username =&gt; "*****"
        password =&gt; "*********"
        }
}</pre>
          </div>
        </div>
        <div class="paragraph">
          <p>In the input section, connect with your log sources, and in the output
            section, direct the filtered output to storage (for example, Elasticsearch)
            or the next stage in your SIEM handling.</p>
        </div>
      </div>
    </div>
    <div class="sect1">
      <h2 id="_details">Details</h2>
      <div class="sectionbody">
        <div class="sect2">
          <h3 id="_cache_size">cache_size</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is: number</p>
              </li>
              <li>
                <p>Default value is: 10000</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>The number of responses cached locally.</p>
          </div>
        </div>
        <div class="sect2">
          <h3 id="_pending_request_limit">pending_request_limit</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is: number</p>
              </li>
              <li>
                <p>Default value is: 10000</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>Max number of requests pending response from the classification center
              === pending_request_timeout - Value type is: number - Default value
              isL 60 (seconds)</p>
          </div>
          <div class="paragraph">
            <p>Timeout for response from classification center (seconds)</p>
          </div>
        </div>
        <div class="sect2">
          <h3 id="_product_type_field">product_type_field</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is: number</p>
              </li>
              <li>
                <p>Default value is</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>The name of the product type field in the log.</p>
          </div>
        </div>
        <div class="sect2">
          <h3 id="_product_name_field">product_name_field</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is: string</p>
              </li>
              <li>
                <p>Default value is</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>The name of the product name field in the log.</p>
          </div>
        </div>
        <div class="sect2">
          <h3 id="_threat">threat</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is: string</p>
              </li>
              <li>
                <p>Default value is</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>The name of the field containing the terms sent to the classification
              center</p>
          </div>
        </div>
        <div class="sect2">
          <h3 id="_src_internal">src_internal</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is: boolean</p>
              </li>
              <li>
                <p>Default value is</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>Indicates whether the source field is internal to the user&#8217;s network
              (for example, an internal host/mail/user/app)</p>
          </div>
        </div>
        <div class="sect2">
          <h3 id="_dst_internal">dst_internal</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is: boolean</p>
              </li>
              <li>
                <p>Default value is</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>Indicates whether the dest fieldis internal to the user&#8217;s network
              (for example, an internal host/mail/user/app)</p>
          </div>
        </div>
        <div class="sect2">
          <h3 id="_tag_on_error">tag_on_error</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is</p>
              </li>
              <li>
                <p>Default value is</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>('_empow_classifer_error')</p>
          </div>
        </div>
        <div class="sect2">
          <h3 id="_tag_on_timeout">tag_on_timeout</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is</p>
              </li>
              <li>
                <p>Default value is</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>(' _empow_classifer_timeout')</p>
          </div>
        </div>
      </div>
    </div>
    <div class="sect1">
      <h2 id="_using_the_empowclassifier_plugin">Using the empowclassifier plugin</h2>
      <div class="sectionbody">
        <div class="sect2">
          <h3 id="_example">Example</h3>
          <div class="paragraph">
            <p>A log may look like this before the classification (in json representation,
              probably not ideal to show on the logstash manuals):</p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="highlight"><code>{
	"product_type": "IDS",
	"product_name": "snort",
	" threat": { "signature": "1:234" }
}</code></pre>
            </div>
          </div>
          <div class="paragraph">
            <p>After filtering, using the plugin, the response would be contain these
              fields:</p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="highlight"><code>{
    "signatureTactics": [
        {
            "tactic": "Full compromise - active patterns",
            "attackStage": "Infiltration",
            "isSrcPerformer": true
        }
    ]
}</code></pre>
            </div>
          </div>
          <div class="paragraph">
            <p><code>signatureTactics</code> is an array of the tactics classified by
              empow.</p>
          </div>
          <div class="paragraph">
            <p>each result contains the actual tactic,</p>
          </div>
          <div class="paragraph">
            <p>the attack stage empow classified for this log (determined by the tactic
              and whether the source and dest are within the user&#8217;s network),</p>
          </div>
          <div class="paragraph">
            <p>and whether the source was the performer or the victim of this attack.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>

</html>
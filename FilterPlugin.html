<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Asciidoctor 1.5.4">
  <meta name="author" content="empow">
  <title>empowclassifier filter plugin</title>
  <link rel="stylesheet" href="https://asciidoclive.com/assets/asciidoctor.js/css/asciidoctor.css">
</head>

<body class="article">
  <div id="header">
    <h1>empowclassifier filter plugin</h1>
    <div class="details">
      <span id="author" class="author">empow</span><br>
      <span id="revnumber">version 0.1 February 2019</span>
    </div>
  </div>
  <div id="content">
    <div id="preamble">
      <div class="sectionbody">
        <div class="ulist">
          <ul>
            <li>
              <p>Plugin version:</p>
            </li>
            <li>
              <p>Released on:</p>
            </li>
            <li>
              <p>Changelog</p>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="sect1">
      <h2 id="_getting_help">Getting Help</h2>
      <div class="sectionbody">
        <div class="paragraph">
          <p>For questions about the plugin, open a topic in the <a href="http://discuss.elastic.co/">Discuss</a>            forums. For bugs or feature requests, open an issue in <a href="https://github.com/logstash-plugins/logstash-filter-fingerprint">Github</a>.
            For the list of Elastic supported plugins, please consult the <a href="https://www.elastic.co/support/matrix#matrix_logstash_plugins">Elastic Support Matrix</a>.</p>
        </div>
      </div>
    </div>
    <div class="sect1">
      <h2 id="_description">Description</h2>
      <div class="sectionbody">
        <div class="paragraph">
          <p>Returns classification information for attacks from the empow classification
            center, based on information in log strings.</p>
        </div>
      </div>
    </div>
    <div class="sect1">
      <h2 id="_configuration_options">Configuration Options</h2>
      <div class="sectionbody">
        <div class="paragraph">
          <p>Include the plugin in the filter section of your logstash config file like
            this:</p>
        </div>
        <div class="listingblock">
          <div class="content">
            <pre>filter {
    empowclassifier {
        username =&gt; "*****"
        password =&gt; "*********"
        }
}</pre>
          </div>
        </div>
        <div class="paragraph">
          <p>In the input section, connect with your log sources, and in the output
            section, direct the filtered output to storage (for example, Elasticsearch)
            or the next stage in your SIEM handling.</p>
        </div>
      </div>
    </div>
    <div class="sect1">
      <h2 id="_details">Details</h2>
      <div class="sectionbody">
        <div class="sect2">
          <h3 id="_username">username</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is: string</p>
              </li>
              <li>
                <p>Default value: ""</p>
              </li>
              <li>
                <p>Required: true</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>The username (typically your email address), to access the classification
              center</p>
          </div>
        </div>
        <div class="sect2">
          <h3 id="_password">password</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is: string</p>
              </li>
              <li>
                <p>Default value: ""</p>
              </li>
              <li>
                <p>Required: true:</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>The password to access the classification center</p>
          </div>
        </div>
        <div class="sect2">
          <h3 id="_authentication_hash">authentication_hash</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is: string</p>
              </li>
              <li>
                <p>Default value: "131n94ktfg7lj8hlpnnbkuiql1"</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>Set this value only if using the complete empow stack; leave unchanged
              if using the empow Elastic open source plugin or module</p>
          </div>
        </div>
        <div class="sect2">
          <h3 id="_cache_size">cache_size</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is: number</p>
              </li>
              <li>
                <p>Default value is: 10000</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>The number of responses cached locally.</p>
          </div>
        </div>
        <div class="sect2">
          <h3 id="_max_pending_requests">max_pending_requests</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is: number</p>
              </li>
              <li>
                <p>Default value is: 10000</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>Max number of requests pending response from the classification center
              === pending_request_timeout - Value type is: number - Default value
              is: 60 (seconds)</p>
          </div>
          <div class="paragraph">
            <p>Timeout for response from classification center (seconds)</p>
          </div>
        </div>
        <div class="sect2">
          <h3 id="_max_classification_center_workers">max_classification_center_workers</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is: number</p>
              </li>
              <li>
                <p>Default value is: 5</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>Maximum number of concurrent threads (workers) classifying logs using
              the classification center</p>
          </div>
        </div>
        <div class="sect2">
          <h3 id="_bulk_request_size">bulk_request_size</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is: number</p>
              </li>
              <li>
                <p>Default value is: 50</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>Classification center bulk request size (requests)</p>
          </div>
        </div>
        <div class="sect2">
          <h3 id="_bulk_request_interval">bulk_request_interval</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is: number</p>
              </li>
              <li>
                <p>Default value is: 2</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>Time (seconds) to wait for batch to fill on classifciation center, before
              querying for the response</p>
          </div>
        </div>
        <div class="sect2">
          <h3 id="_max_query_retries">max_query_retries</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is: number</p>
              </li>
              <li>
                <p>Default value is: 5</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>Max number of classification center request retries</p>
          </div>
        </div>
        <div class="sect2">
          <h3 id="_time_between_queries">time_between_queries</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is: number</p>
              </li>
              <li>
                <p>Default value is: 10</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>Time (seconds) to wait between queries to the classification center for
              the final response to a request; the classification center will return
              an 'in-progress' response if queried before the final response is ready</p>
          </div>
        </div>
        <div class="sect2">
          <h3 id="_product_type_field">product_type_field</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is: number</p>
              </li>
              <li>
                <p>Default value is: 'product_type'</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>The name of the product type field in the log</p>
          </div>
          <div class="paragraph">
            <p>Example: If the log used <em>log_type</em> for the product type, configure
              the plugin like this:</p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre> filter {
  empowclassifier {
    username =&gt; "happy"
    password =&gt; "festivus"
    product_type_field =&gt; "log_type"
   }
  }</pre>
            </div>
          </div>
        </div>
        <div class="sect2">
          <h3 id="_product_name_field">product_name_field</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is: string</p>
              </li>
              <li>
                <p>Default value is: 'product_name'</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>The name of the product name field in the log</p>
          </div>
          <div class="paragraph">
            <p>Example: If the log used <em>product</em> for the product name, configure
              the plugin like this:</p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre> filter {
   empowclassifier {
   username =&gt; "happy"
   password =&gt; "festivus"
   product_type_field =&gt; "product"
   }
 }</pre>
            </div>
          </div>
        </div>
        <div class="sect2">
          <h3 id="_threat_field">threat_field</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is: string</p>
              </li>
              <li>
                <p>Default value is: 'threat'</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>The name of the field containing the terms sent to the classification
              center</p>
          </div>
        </div>
        <div class="sect2">
          <h3 id="_src_internal">src_internal</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is: boolean</p>
              </li>
              <li>
                <p>Default value is: 'is_src_internal'</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>Indicates whether the source field is internal to the user&#8217;s network
              (for example, an internal host/mail/user/app)</p>
          </div>
        </div>
        <div class="sect2">
          <h3 id="_dst_internal">dst_internal</h3>
          <div class="ulist">
            <ul>
              <li>
                <p>Value type is: boolean</p>
              </li>
              <li>
                <p>Default value is: 'is_dst_internal'</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>Indicates whether the dest field is internal to the user&#8217;s network
              (for example, an internal host/mail/user/app)</p>
          </div>
        </div>
      </div>
    </div>
    <div class="sect1">
      <h2 id="_using_the_empowclassifier_plugin">Using the empowclassifier plugin</h2>
      <div class="sectionbody">
        <div class="sect2">
          <h3 id="_example">Example</h3>
          <div class="paragraph">
            <p>A log may look like this before the classification (in json form):</p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="highlight"><code>{
	"product_type": "IDS",
	"product_name": "snort",
	" threat": { "signature": "1:234" }
}</code></pre>
            </div>
          </div>
          <div class="paragraph">
            <p>After filtering, using the plugin, the response would be contain these
              fields:</p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="highlight"><code>{
    "signatureTactics": [
        {
            "tactic": "Full compromise - active patterns",
            "attackStage": "Infiltration",
            "isSrcPerformer": true
        }
    ]
}</code></pre>
            </div>
          </div>
          <div class="paragraph">
            <p><code>signatureTactics</code> is an array of the tactics classified by
              empow.</p>
          </div>
          <div class="paragraph">
            <p>each result contains the actual tactic, the attack stage empow classified
              for this log (determined by the tactic and whether the source and dest
              are within the user&#8217;s network), and whether the source was the
              performer or the victim of this attack.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>

</html>